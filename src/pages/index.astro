---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { t, calculatorPaths } from '@/utils/i18n';
import { getCategoryName } from '@/config/categories';

const calculators = [
  {
    title: t('bmi.title', 'en'),
    description: t('bmi.description', 'en'),
    url: calculatorPaths.bmi.en,
    category: getCategoryName('bmi', 'en'),
    icon: '‚öïÔ∏è',
  },
  {
    title: t('calorie.title', 'en'),
    description: t('calorie.description', 'en'),
    url: calculatorPaths.calorie.en,
    category: getCategoryName('calorie', 'en'),
    icon: 'üî•',
  },
  {
    title: t('idealWeight.title', 'en'),
    description: t('idealWeight.description', 'en'),
    url: calculatorPaths.idealWeight.en,
    category: getCategoryName('ideal-weight', 'en'),
    icon: 'üéØ',
  },
  {
    title: t('bodyFat.title', 'en'),
    description: t('bodyFat.description', 'en'),
    url: calculatorPaths.bodyFat.en,
    category: getCategoryName('body-fat', 'en'),
    icon: 'üìä',
  },
  {
    title: t('bmr.title', 'en'),
    description: t('bmr.description', 'en'),
    url: calculatorPaths.bmr.en,
    category: getCategoryName('bmr', 'en'),
    icon: '‚ö°',
  },
  {
    title: t('tdee.title', 'en'),
    description: t('tdee.description', 'en'),
    url: calculatorPaths.tdee.en,
    category: getCategoryName('tdee', 'en'),
    icon: 'üí™',
  },
  {
    title: t('macro.title', 'en'),
    description: t('macro.description', 'en'),
    url: calculatorPaths.macro.en,
    category: getCategoryName('macro', 'en'),
    icon: 'üçΩÔ∏è',
  },
  {
    title: t('pregnancy.title', 'en'),
    description: t('pregnancy.description', 'en'),
    url: calculatorPaths.pregnancy.en,
    category: getCategoryName('pregnancy', 'en'),
    icon: 'ü§∞',
  },
  {
    title: t('pregnancyWeightGain.title', 'en'),
    description: t('pregnancyWeightGain.description', 'en'),
    url: calculatorPaths.pregnancyWeightGain.en,
    category: getCategoryName('pregnancy-weight-gain', 'en'),
    icon: '‚öñÔ∏è',
  },
  {
    title: t('pregnancyConception.title', 'en'),
    description: t('pregnancyConception.description', 'en'),
    url: calculatorPaths.pregnancyConception.en,
    category: getCategoryName('pregnancy-conception', 'en'),
    icon: 'üë∂',
  },
  {
    title: t('dueDate.title', 'en'),
    description: t('dueDate.description', 'en'),
    url: calculatorPaths.dueDate.en,
    category: getCategoryName('due-date', 'en'),
    icon: 'üìÖ',
  },
  {
    title: t('pace.title', 'en'),
    description: t('pace.description', 'en'),
    url: calculatorPaths.pace.en,
    category: getCategoryName('pace', 'en'),
    icon: 'üèÉ',
  },
  {
    title: t('armyBodyFat.title', 'en'),
    description: t('armyBodyFat.description', 'en'),
    url: calculatorPaths.armyBodyFat.en,
    category: getCategoryName('army-body-fat', 'en'),
    icon: 'üéñÔ∏è',
  },
  {
    title: t('carbohydrate.title', 'en'),
    description: t('carbohydrate.description', 'en'),
    url: calculatorPaths.carbohydrate.en,
    category: getCategoryName('carbohydrate', 'en'),
    icon: 'üçû',
  },
  {
    title: t('leanBodyMass.title', 'en'),
    description: t('leanBodyMass.description', 'en'),
    url: calculatorPaths.leanBodyMass.en,
    category: getCategoryName('lean-body-mass', 'en'),
    icon: 'üí™',
  },
  {
    title: t('healthyWeight.title', 'en'),
    description: t('healthyWeight.description', 'en'),
    url: calculatorPaths.healthyWeight.en,
    category: getCategoryName('healthy-weight', 'en'),
    icon: '‚úÖ',
  },
  {
    title: t('protein.title', 'en'),
    description: t('protein.description', 'en'),
    url: calculatorPaths.protein.en,
    category: getCategoryName('protein', 'en'),
    icon: 'ü•©',
  },
  {
    title: t('bodyType.title', 'en'),
    description: t('bodyType.description', 'en'),
    url: calculatorPaths.bodyType.en,
    category: getCategoryName('body-type', 'en'),
    icon: 'üßç',
  },
  {
    title: t('caloriesBurned.title', 'en'),
    description: t('caloriesBurned.description', 'en'),
    url: calculatorPaths.caloriesBurned.en,
    category: getCategoryName('calories-burned', 'en'),
    icon: 'üî•',
  },
  {
    title: t('bsa.title', 'en'),
    description: t('bsa.description', 'en'),
    url: calculatorPaths.bsa.en,
    category: getCategoryName('bsa', 'en'),
    icon: 'üìê',
  },
  {
    title: t('bloodType.title', 'en'),
    description: t('bloodType.description', 'en'),
    url: calculatorPaths.bloodType.en,
    category: getCategoryName('blood-type', 'en'),
    icon: 'ü©∏',
  },
  {
    title: t('ovulation.title', 'en'),
    description: t('ovulation.description', 'en'),
    url: calculatorPaths.ovulation.en,
    category: getCategoryName('ovulation', 'en'),
    icon: 'ü•ö',
  },
  {
    title: t('period.title', 'en'),
    description: t('period.description', 'en'),
    url: calculatorPaths.period.en,
    category: getCategoryName('period', 'en'),
    icon: 'üìÖ',
  },
  {
    title: t('bodyFrame.title', 'en'),
    description: t('bodyFrame.description', 'en'),
    url: calculatorPaths.bodyFrame.en,
    category: getCategoryName('body-frame', 'en'),
    icon: 'üìè',
  },
  {
    title: t('heartRate.title', 'en'),
    description: t('heartRate.description', 'en'),
    url: calculatorPaths.heartRate.en,
    category: getCategoryName('heart-rate', 'en'),
    icon: 'üíó',
  },
  {
    title: t('waistHip.title', 'en'),
    description: t('waistHip.description', 'en'),
    url: calculatorPaths.waistHip.en,
    category: getCategoryName('waist-hip', 'en'),
    icon: 'üìä',
  },
  {
    title: t('oneRepMax.title', 'en'),
    description: t('oneRepMax.description', 'en'),
    url: calculatorPaths.oneRepMax.en,
    category: getCategoryName('one-rep-max', 'en'),
    icon: 'üí™',
  },
  {
    title: t('fatIntake.title', 'en'),
    description: t('fatIntake.description', 'en'),
    url: calculatorPaths.fatIntake.en,
    category: getCategoryName('fat-intake', 'en'),
    icon: 'ü•ë',
  },
  {
    title: t('gfr.title', 'en'),
    description: t('gfr.description', 'en'),
    url: calculatorPaths.gfr.en,
    category: getCategoryName('gfr', 'en'),
    icon: 'üè•',
  },
  {
    title: t('bac.title', 'en'),
    description: t('bac.description', 'en'),
    url: calculatorPaths.bac.en,
    category: getCategoryName('bac', 'en'),
    icon: 'üç∫',
  },
  {
    title: t('weightWatchers.title', 'en'),
    description: t('weightWatchers.description', 'en'),
    url: calculatorPaths.weightWatchers.en,
    category: getCategoryName('weight-watchers', 'en'),
    icon: '‚öñÔ∏è',
  },
];
---

<BaseLayout
  title={t('site.title', 'en')}
  description={t('site.description', 'en')}
  lang="en"
>
  <!-- Hero Section -->
  <div class="hero bg-gradient-to-b from-primary/5 to-base-100 py-16">
    <div class="hero-content text-center">
      <div class="max-w-3xl">
        <h1 class="text-5xl font-bold text-base-content mb-4">{t('site.title', 'en')}</h1>
        <p class="text-xl text-base-content/70">{t('site.description', 'en')}</p>
      </div>
    </div>
  </div>

  <!-- Calculators Section -->
  <div class="container mx-auto px-4 py-8">
    <section>
      <h2 class="text-3xl font-bold text-center mb-8">Featured Calculators</h2>

      <!-- Search Box -->
      <div class="mb-8 max-w-2xl mx-auto">
        <input
          type="text"
          id="search"
          placeholder={t('common.search', 'en')}
          autocomplete="off"
          class="input input-bordered w-full input-lg"
        />
      </div>

      <!-- Calculators Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="calculators-grid">
        {calculators.map((calc) => (
          <a href={calc.url} class="card bg-base-100 shadow-xl hover:shadow-2xl transition-all hover:-translate-y-1" data-title={calc.title.toLowerCase()} data-description={calc.description.toLowerCase()}>
            <div class="card-body">
              <div class="text-5xl mb-4">{calc.icon}</div>
              <h3 class="card-title text-lg">{calc.title}</h3>
              <p class="text-base-content/70 flex-grow">{calc.description}</p>
              <div class="card-actions justify-end">
                <span class="badge badge-primary badge-outline">{calc.category}</span>
              </div>
            </div>
          </a>
        ))}
      </div>

      <!-- No Results Message -->
      <p class="text-center py-12 text-base-content/50 text-lg" id="no-results" style="display: none;">
        {t('common.noResults', 'en')}
      </p>
    </section>
  </div>

  <script>
    const searchInput = document.getElementById('search') as HTMLInputElement;
    const calculatorsGrid = document.getElementById('calculators-grid') as HTMLElement;
    const noResults = document.getElementById('no-results') as HTMLElement;
    const cards = Array.from(calculatorsGrid.querySelectorAll('.card'));

    searchInput?.addEventListener('input', (e) => {
      const searchTerm = (e.target as HTMLInputElement).value.toLowerCase();
      let visibleCount = 0;

      cards.forEach((card) => {
        const title = card.getAttribute('data-title') || '';
        const description = card.getAttribute('data-description') || '';
        const matches = title.includes(searchTerm) || description.includes(searchTerm);

        if (matches) {
          (card as HTMLElement).style.display = '';
          visibleCount++;
        } else {
          (card as HTMLElement).style.display = 'none';
        }
      });

      if (visibleCount === 0) {
        noResults.style.display = 'block';
      } else {
        noResults.style.display = 'none';
      }
    });
  </script>
</BaseLayout>
